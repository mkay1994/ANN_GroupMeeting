clear
clc

%% Load dataset
[x,y] = bodyfat_dataset;

%% The inpiuts x1 to x13 are as follows:
% Age (years)
% Weight (lbs)
% Height (inches)
% Neck circumference (cm)
% Chest circumference (cm)
% Abdomen circumference (cm)
% Hip circumference (cm)
% Thigh circumference (cm)
% Knee circumference (cm)
% Ankle circumference (cm)
% Biceps (extended) circumference (cm)
% Forearm circumference (cm)
% Wrist circumference (cm)
syms x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 x13
X = [x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 x13];


%% Normalize/denormalize data i/o
xoffset = [22;118.5;29.5;31.1;79.3;69.4;85;47.2;33;19.1;24.8;21;15.8];
xgain = [0.0338983050847458;0.00817494379726139;0.0414507772020725;0.099502487562189;0.0351493848857645;0.0254129606099111;0.0318979266347687;0.0498753117206983;0.124223602484472;0.135135135135135;0.099009900990099;0.143884892086331;0.357142857142857];
xmin = -1;
ygain = 0.0421052631578947;
yoffset = 0;
ymin = -1;


%% Weights and biases
% hidden layer
b1 = [-1.3275191015531138117;0.65750242483459064857;-5.6535142371300128872;-7.2807678862706035616];
IW1_1 = [-2.19111637126987846 13.48028565094002218 -10.628091480927290391 1.7711267419542873203 -0.37358216465415594598 -5.8469257846001587708 -13.952409955807315356 -4.153290374510232752 7.5339023458992748772 -8.5144093520152974719 1.19811832405332086 -2.6485855094218027084 -0.76234447471156052689;-0.15384079801249009312 0.28490763834356325201 -0.82585961737840951624 -0.32765603875006138468 -0.20022265219237003753 1.8091197653322044214 -0.77432831804263235753 -0.10943766704220198038 0.14501331216449575567 -0.2542004528181223133 0.32178387687810144913 0.011757965229029799029 -0.15337582198794696975;1.5971472146269078962 -6.8285878070406758056 7.4442994849436825433 4.2787562606755757955 0.58164924091642311588 4.8620747698679274151 -5.7888397137215932275 7.6870257084242155088 1.5088118723650083552 0.39428356718958479377 -5.7642215736874220511 -1.2057196839690096368 -3.1392115130183788629;0.86183228839800984922 -4.9514237525552768915 5.485543086458376294 -1.0224642124391190023 3.4166980996542672955 -2.1283565302047979806 2.12153338581691564 -0.36716748514691888161 -2.4284953812057503697 0.43412295812611856327 2.2568275582471319929 3.0665055380487022951 0.97628444190004315395];
% output layer
b2 = -0.10143585329553034269;
LW2_1 = [-0.18133571330467776472 0.85686361832661606108 0.07883299445603464406 0.11451927038640841161];

sum1 = 0;
for i=1:length(LW2_1)
    sum2 = 0;
    for j=1:length(X)
          sum2 = sum2 + IW1_1(i,j)*(xmin+xgain(j)*(X(j)-xoffset(j)));
    end
    sum2 = sum2 + b1(i);
	sum1 = sum1 + LW2_1(i)*tansig(sum2);
end
sum1 = b2+sum1;
f = (sum1-ymin)/ygain + yoffset;

s=50;
yAnn1 = double(subs(subs(subs(subs(subs(subs(subs(subs(subs(subs(subs(subs(subs(f,x1,x(1,s)),...
    x2,x(2,s)),x3,x(3,s)),x4,x(4,s)),x5,x(5,s)),x6,x(6,s)),x7,x(7,s)),x8,x(8,s)),x9,x(9,s)),x10,x(10,s)),...
    x11,x(11,s)),x12,x(12,s)),x13,x(13,s)))
yTrue1 = y(s)